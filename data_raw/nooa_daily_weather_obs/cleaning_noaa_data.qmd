---
title: "cleaning_nooa_data"
format: html
editor: visual
---

```{r}

library(tidyverse)

```

```{r}

source("./helper_functions/read_and_clean.R")

```

```{r}

#USC00052223 is in an area of high impevious surfaces on average has a higher degree temp. 

bind_rows(read_and_clean("./raw_data_sets/USC00052223.dly"), read_and_clean("./raw_data_sets/USW00023062.dly")) %>% 
  group_by(date, station_id) %>% 
  summarise(mean_temp = mean((TMAX + TMIN) / 2, na.rm = TRUE)) %>% 
  filter(date > as.Date("2018-01-01")) 

```


```{r}

read_fwf("./raw_data_sets/ghcnd-stations.txt", 
         col_positions = fwf_widths(c(11, 10, 10, 10, 100))) %>% 
  rename(station_id = X1, latitude = X2, longitude = X3, elevation_state = X4, Name = X5) %>% 
  filter( station_id %in% c("USW00023062", "USC00052223")) %>% 
  mutate(elevation = str_extract(elevation_state, "-?\\d+")) %>% 
  mutate(state = str_extract(elevation_state, "[:upper:]+")) %>% 
  mutate(elevation = case_when(
    elevation == 999 | elevation == -999 ~ NA,  
    TRUE ~ elevation)) %>% 
  mutate(elevation = as.double(elevation)) %>%
  select(-elevation_state) %>% 
  right_join(bind_rows(read_and_clean("./raw_data_sets/USC00052223.dly"),
                       read_and_clean("./raw_data_sets/USW00023062.dly")), 
             by = "station_id") %>% 
  mutate()


```


