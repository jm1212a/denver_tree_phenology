---
title: "Denver Climate Boxplot"
author: "Jared Martin"
date: "2025-10-13"
output: html_document
---

```{r}

library(tidyverse)

denver_temps <- tribble(
  ~Year, ~Jan, ~Feb, ~Mar, ~Apr, ~May, ~Jun, ~Jul, ~Aug, ~Sep, ~Oct, ~Nov, ~Dec, ~Annual,
  1970, 30.6, 38.5, 33.5, 43.7, 58.8, 65.2, 71.9, 73.8, 59.5, 45.9, 39.1, 33.3, 49.5,
  1971, 32.0, 30.6, 38.5, 47.8, 54.1, 69.0, 70.6, 72.7, 57.5, 49.4, 39.1, 31.9, 49.4,
  1972, 30.5, 36.1, 44.7, 48.5, 57.0, 68.3, 70.2, 71.0, 62.1, 52.0, 32.8, 24.9, 49.8,
  1973, 27.3, 35.4, 39.9, 43.2, 55.6, 67.5, 71.0, 73.4, 59.9, 54.5, 39.5, 31.5, 49.9,
  1974, 23.7, 35.1, 43.1, 47.9, 61.6, 68.4, 74.6, 69.5, 59.4, 52.4, 38.0, 31.2, 50.4,
  1975, 31.6, 30.6, 37.2, 44.1, 54.2, 64.2, 72.7, 70.7, 59.5, 53.2, 36.8, 37.5, 49.4,
  1976, 32.3, 39.3, 37.1, 49.1, 56.6, 66.3, 75.2, 70.2, 61.8, 48.4, 39.5, 35.4, 50.9,
  1977, 29.2, 37.9, 39.9, 51.0, 60.7, 71.9, 74.3, 70.2, 66.6, 53.2, 40.3, 35.0, 52.5,
  1978, 25.8, 31.3, 43.3, 50.3, 54.4, 66.9, 74.7, 69.6, 65.0, 53.0, 37.8, 24.6, 49.7,
  1979, 18.0, 34.2, 40.5, 49.1, 54.8, 65.8, 73.7, 69.5, 66.3, 53.8, 33.3, 34.5, 49.5,
  1980, 25.9, 34.5, 38.0, 47.7, 57.1, 71.9, 76.4, 73.1, 65.8, 52.4, 41.9, 41.2, 52.2,
  1981, 37.3, 36.1, 41.2, 56.4, 57.0, 70.4, 75.9, 72.0, 68.2, 52.6, 45.9, 35.8, 54.1,
  1982, 30.2, 32.0, 41.1, 47.4, 55.0, 63.1, 72.6, 73.1, 61.7, 49.0, 35.6, 30.9, 49.3,
  1983, 31.9, 36.6, 36.2, 41.0, 51.4, 62.8, 73.2, 74.4, 64.9, 52.7, 37.0, 17.4, 48.3,
  1984, 27.2, 34.1, 37.1, 42.3, 59.9, 66.5, 74.9, 71.8, 60.7, 44.7, 39.7, 32.8, 49.3,
  1985, 25.5, 27.6, 40.8, 51.0, 59.9, 68.0, 73.0, 72.3, 58.8, 50.7, 29.7, 29.4, 48.9,
  1986, 40.3, 36.1, 47.1, 49.6, 56.7, 70.3, 73.5, 72.1, 60.6, 49.3, 39.0, 31.0, 52.1,
  1987, 32.1, 36.1, 38.8, 51.8, 59.6, 69.2, 74.4, 70.7, 62.4, 51.6, 39.9, 28.4, 51.2,
  1988, 25.1, 34.1, 38.5, 50.2, 59.0, 71.8, 74.1, 73.6, 62.3, 54.0, 40.6, 31.1, 51.2,
  1989, 33.5, 22.3, 43.3, 51.0, 59.0, 65.4, 75.8, 71.6, 62.4, 51.2, 42.8, 27.3, 50.5,
  1990, 36.4, 33.3, 39.5, 49.1, 56.5, 72.6, 70.8, 71.3, 66.9, 52.2, 44.0, 25.7, 51.5,
  1991, 27.8, 40.3, 42.8, 47.8, 60.2, 69.4, 73.1, 71.4, 62.5, 50.3, 34.7, 33.1, 51.1,
  1992, 31.8, 40.1, 43.0, 54.8, 60.6, 66.1, 70.5, 68.4, 65.2, 53.6, 33.9, 25.4, 51.1,
  1993, 27.3, 29.4, 42.5, 48.5, 58.8, 66.4, 73.0, 70.0, 60.6, 49.1, 34.7, 34.1, 49.5,
  1994, 34.3, 33.4, 44.8, 48.8, 63.2, 73.5, 73.9, 75.0, 67.2, 52.0, 37.9, 36.0, 53.3,
  1995, 33.9, 38.5, 39.3, 42.9, 50.0, 62.2, 70.9, 75.3, 61.7, 48.5, 41.9, 33.1, 49.9,
  1996, 27.1, 33.9, 36.0, 48.0, 58.1, 68.2, 73.4, 71.6, 60.8, 50.8, 37.2, 33.0, 49.8,
  1997, 27.9, 29.9, 42.1, 40.5, 56.6, 67.8, 73.0, 69.6, 64.2, 49.6, 34.8, 27.9, 48.7,
  1998, 32.7, 33.9, 36.9, 44.8, 59.1, 63.0, 74.3, 71.7, 68.0, 50.2, 42.1, 28.9, 50.5,
  1999, 33.7, 38.6, 43.7, 42.5, 54.8, 64.2, 73.9, 71.2, 59.2, 52.5, 47.2, 33.7, 51.3,
  2000, 33.0, 39.1, 40.4, 49.8, 59.2, 66.9, 76.7, 74.5, 63.6, 50.5, 28.9, 28.2, 50.9,
  2001, 30.0, 28.3, 39.7, 49.6, 57.0, 69.3, 76.7, 73.5, 66.8, 51.5, 40.9, 31.7, 51.3,
  2002, 29.3, 33.6, 33.8, 50.0, 56.1, 71.1, 76.2, 71.5, 63.6, 43.9, 37.5, 33.6, 50.0,
  2003, 36.9, 27.6, 39.9, 50.4, 57.5, 62.1, 76.9, 73.7, 59.3, 55.1, 36.2, 32.5, 50.7,
  2004, 31.8, 30.8, 46.4, 47.5, 59.3, 63.7, 70.8, 68.2, 62.7, 50.8, 37.2, 34.8, 50.3,
  2005, 32.5, 35.8, 39.4, 46.4, 57.0, 66.0, 77.7, 71.6, 67.2, 52.0, 42.5, 30.1, 51.5,
  2006, 37.4, 30.9, 38.4, 51.5, 60.3, 72.8, 76.2, 72.8, 58.9, 49.5, 40.5, 31.7, 51.7,
  2007, 20.8, 29.0, 46.0, 46.8, 58.0, 68.8, 76.3, 75.4, 65.1, 53.5, 41.4, 26.7, 50.7,
  2008, 27.9, 33.9, 39.5, 46.1, 55.8, 67.4, 77.6, 71.4, 61.8, 52.1, 43.1, 26.6, 50.3,
  2009, 34.9, 37.3, 41.8, 45.9, 59.0, 64.4, 70.2, 70.3, 63.5, 42.9, 42.6, 24.1, 49.7,
  2010, 30.3, 29.1, 41.0, 47.8, 54.0, 68.9, 74.4, 73.8, 67.0, 55.3, 38.3, 34.3, 51.2,
  2011, 29.9, 29.0, 43.3, 48.4, 53.1, 68.2, 75.9, 77.0, 64.2, 52.6, 39.5, 26.6, 50.6,
  2012, 36.0, 28.4, 49.2, 53.3, 60.5, 75.0, 78.9, 75.0, 66.3, 49.0, 43.5, 31.5, 53.9,
  2013, 30.3, 30.1, 37.7, 41.7, 57.9, 71.1, 74.3, 74.6, 66.4, 47.7, 40.9, 28.4, 50.1,
  2014, 31.1, 28.2, 40.9, 49.0, 57.5, 67.3, 74.5, 70.6, 64.8, 55.1, 36.2, 31.3, 50.5,
  2015, 33.9, 33.8, 45.0, 48.7, 53.0, 69.5, 72.8, 74.0, 69.4, 56.5, 38.5, 29.4, 52.0,
  2016, 31.8, 37.8, 41.6, 47.2, 54.4, 70.8, 76.2, 71.2, 66.0, 57.8, 45.1, 27.8, 52.3,
  2017, 30.0, 40.3, 47.9, 48.9, 55.9, 69.5, 76.4, 71.5, 65.1, 50.1, 45.3, 33.2, 52.8,
  2018, 34.6, 29.9, 42.7, 47.8, 61.4, 72.4, 75.3, 72.4, 67.8, 49.2, 37.8, 32.5, 52.0,
  2019, 32.0, 28.0, 35.1, 49.1, 51.6, 65.6, 75.7, 75.4, 69.3, 43.7, 36.2, 33.7, 49.6,
  2020, 34.6, 28.1, 42.5, 46.3, 59.6, 71.1, 76.5, 77.0, 65.4, 49.8, 43.7, 33.1, 52.3,
  2021, 33.9, 25.4, 39.4, 46.2, 56.1, 71.6, 76.7, 75.4, 68.8, 53.9, 46.3, 38.4, 52.7,
  2022, 30.9, 29.1, 39.4, 48.2, 56.8, 70.2, 78.0, 76.1, 69.0, 53.8, 35.6, 29.3, 51.4,
  2023, 25.0, 31.1, 35.9, 47.8, 59.4, 64.2, 73.9, 74.2, 68.0, 52.5, 43.2, 37.4, 51.1,
  2024, 28.2, 37.6, 41.4, 50.5, 56.9, 73.8, 75.7, 75.6, 70.0, 59.1, 38.2, 39.4, 53.9,
  2025, 25.8, 31.2, 45.8, 49.5, 57.7, 69.0, 75.1, 73.8, 64.7, NA, NA, NA, 54.7
)


denver_temps_long <- denver_temps %>%
  pivot_longer(cols = Jan:Dec, 
               names_to = 'Month',
               values_to = 'Temperature') %>%
  mutate(Month = factor(Month, levels = month.abb))

denver_temps_long %>% 
  select(-Annual) -> denver_temps_long


```

```{r}

library(tidyverse)

denver_precip <- tribble(
  ~Year, ~Jan, ~Feb, ~Mar, ~Apr, ~May, ~Jun, ~Jul, ~Aug, ~Sep, ~Oct, ~Nov, ~Dec, ~Annual,
  1970, 0.10, 0.01, 1.34, 0.97, 0.64, 3.83, 1.67, 0.54, 2.47, 0.88, 1.19, 0.09, 13.73,
  1971, 0.35, 0.78, 0.53, 1.98, 1.34, 0.23, 1.20, 0.85, 2.85, 0.44, 0.16, 0.25, 10.96,
  1972, 0.36, 0.44, 0.50, 3.52, 0.49, 2.94, 0.63, 2.71, 2.07, 0.82, 1.69, 0.70, 16.87,
  1973, 1.31, 0.16, 1.76, 3.73, 5.06, 0.20, 2.47, 1.28, 2.85, 0.47, 0.83, 2.84, 22.96,
  1974, 1.03, 0.82, 1.32, 2.28, 0.06, 2.01, 2.34, 0.16, 0.98, 1.68, 1.06, 0.29, 14.03,
  1975, 0.23, 0.37, 1.19, 1.14, 2.80, 2.11, 2.78, 2.00, 0.24, 0.30, 1.88, 0.47, 15.51,
  1976, 0.19, 0.54, 1.34, 1.27, 1.34, 0.63, 2.31, 2.50, 1.88, 0.93, 0.32, 0.16, 13.41,
  1977, 0.16, 0.27, 1.24, 2.13, 0.34, 1.02, 2.98, 1.00, 0.10, 0.48, 0.59, 0.03, 10.34,
  1978, 0.27, 0.27, 1.07, 1.82, 3.46, 1.17, 0.54, 0.26, 0.07, 1.45, 0.50, 0.82, 11.70,
  1979, 0.34, 0.42, 1.25, 1.41, 3.53, 2.39, 0.81, 5.85, 0.36, 1.28, 1.66, 1.06, 20.36,
  1980, 0.64, 0.45, 1.15, 2.54, 2.73, 0.09, 2.93, 1.65, 0.63, 0.10, 0.66, 0.10, 13.67,
  1981, 0.29, 0.35, 2.27, 1.01, 3.76, 0.63, 0.90, 1.16, 0.35, 0.79, 0.42, 0.66, 12.59,
  1982, 0.32, 0.09, 0.18, 0.34, 3.48, 2.26, 0.92, 1.16, 1.38, 1.51, 0.47, 2.34, 14.45,
  1983, 0.15, 0.07, 4.56, 2.10, 3.62, 2.65, 1.75, 1.51, 0.13, 0.39, 2.63, 0.63, 20.19,
  1984, 0.18, 0.81, 1.19, 2.42, 0.65, 1.26, 2.11, 3.20, 0.47, 3.47, 0.27, 0.46, 16.49,
  1985, 0.68, 0.59, 0.69, 2.61, 1.33, 1.46, 3.71, 0.28, 2.33, 0.77, 1.20, 0.66, 16.31,
  1986, 0.22, 0.65, 0.43, 2.59, 1.30, 1.07, 1.69, 0.53, 0.43, 1.80, 1.07, 0.31, 12.09,
  1987, 0.69, 1.21, 1.34, 1.03, 4.64, 3.50, 0.76, 2.00, 0.70, 1.24, 1.62, 1.30, 20.03,
  1988, 0.40, 0.60, 1.28, 0.65, 4.26, 1.28, 2.19, 1.83, 0.90, 0.06, 0.47, 1.04, 14.96,
  1989, 1.14, 0.66, 0.56, 1.00, 3.83, 2.04, 1.64, 1.28, 1.55, 0.81, 0.15, 0.81, 15.47,
  1990, 0.74, 0.55, 3.10, 1.01, 1.51, 0.21, 3.57, 1.96, 1.46, 1.03, 1.28, 0.27, 16.69,
  1991, 0.76, 0.08, 0.76, 1.94, 2.43, 2.20, 4.11, 3.69, 0.79, 0.70, 2.67, 0.19, 20.32,
  1992, 1.19, 0.09, 3.50, 0.53, 1.13, 2.02, 2.23, 2.33, 0.01, 0.51, 1.46, 0.68, 15.68,
  1993, 0.25, 1.05, 0.89, 2.08, 0.93, 1.67, 0.91, 0.64, 2.29, 2.27, 1.38, 0.42, 14.78,
  1994, 0.54, 0.81, 0.87, 1.88, 1.27, 0.99, 0.50, 0.61, 0.45, 1.44, 1.34, 0.30, 11.00,
  1995, 0.21, 0.88, 0.28, 2.44, 4.67, 3.07, 2.31, 1.04, 2.28, 0.72, 0.31, 0.05, 18.26,
  1996, 0.29, 0.09, 0.77, 0.33, 2.40, 1.77, 1.01, 0.56, 2.34, 0.39, 0.38, 0.06, 10.39,
  1997, 0.26, 0.54, 0.26, 1.30, 1.57, 2.57, 5.60, 3.52, 0.97, 1.87, 0.61, 0.50, 19.57,
  1998, 0.05, 0.23, 0.86, 2.47, 1.73, 0.73, 5.92, 1.19, 0.73, 1.20, 0.40, 0.42, 15.93,
  1999, 0.38, 0.15, 0.19, 5.86, 2.37, 2.52, 3.84, 3.37, 1.20, 0.31, 0.47, 0.29, 20.95,
  2000, 0.24, 0.23, 1.96, 0.71, 3.09, 0.79, 1.42, 3.06, 1.52, 0.52, 0.61, 0.27, 14.42,
  2001, 0.78, 0.64, 1.10, 1.20, 3.80, 1.53, 4.76, 0.71, 1.00, 0.08, 0.72, 0.14, 16.46,
  2002, 0.48, 0.32, 0.53, 0.23, 0.94, 1.45, 1.39, 0.78, 0.58, 0.49, 0.24, 0.05, 7.48,
  2003, 0.03, 0.47, 3.05, 2.22, 1.91, 3.95, 0.54, 1.24, 0.26, 0.08, 0.05, 0.12, 13.92,
  2004, 0.23, 0.21, 0.14, 1.76, 1.30, 2.33, 2.51, 2.84, 1.99, 0.86, 0.45, 0.04, 14.66,
  2005, 0.37, 0.02, 0.59, 2.45, 0.71, 3.99, 0.27, 1.33, 0.07, 2.16, 0.48, 0.35, 12.79,
  2006, 0.28, 0.15, 0.56, 0.67, 0.94, 0.12, 1.37, 1.13, 0.84, 1.03, 0.34, 1.21, 8.64,
  2007, 0.55, 0.36, 0.57, 2.65, 1.79, 0.52, 0.43, 2.76, 0.54, 3.03, 0.20, 0.60, 14.00,
  2008, 0.08, 0.18, 0.14, 0.32, 1.56, 0.73, 0.24, 4.03, 1.04, 1.44, 0.18, 0.24, 10.18,
  2009, 0.13, 0.04, 0.83, 3.22, 1.30, 4.86, 3.56, 1.14, 0.74, 1.36, 0.49, 0.45, 18.12,
  2010, 0.07, 0.30, 0.80, 2.51, 1.52, 1.60, 3.70, 1.05, 0.06, 0.54, 0.49, 0.22, 12.86,
  2011, 0.61, 0.42, 0.35, 1.07, 4.79, 2.43, 3.41, 0.30, 0.89, 1.79, 0.47, 0.78, 17.31,
  2012, 0.26, 0.90, 0.03, 1.39, 1.01, 1.22, 0.48, 0.11, 2.95, 1.22, 0.27, 0.27, 10.11,
  2013, 0.31, 0.77, 1.47, 1.87, 0.82, 0.75, 1.98, 2.78, 5.61, 0.72, 0.12, 0.28, 17.48,
  2014, 0.94, 0.19, 0.83, 1.24, 3.51, 1.82, 3.85, 2.73, 1.79, 0.52, 0.76, 0.59, 18.77,
  2015, 0.38, 1.25, 0.79, 2.65, 3.76, 2.53, 1.06, 1.18, 0.11, 1.76, 2.13, 0.71, 18.31,
  2016, 0.50, 0.48, 1.18, 2.56, 2.38, 1.62, 1.07, 0.22, 0.28, 0.26, 0.52, 0.78, 11.85,
  2017, 0.54, 0.23, 0.90, 0.98, 3.66, 0.33, 0.47, 1.86, 1.26, 0.96, 0.29, 0.21, 11.69,
  2018, 0.54, 0.31, 1.02, 0.86, 1.86, 0.43, 1.03, 0.93, 0.18, 0.99, 0.35, 0.03, 8.53,
  2019, 0.75, 0.72, 1.39, 1.25, 3.23, 2.24, 2.42, 0.58, 0.41, 0.91, 1.31, 0.30, 15.51,
  2020, 0.14, 0.88, 1.26, 0.54, 1.65, 0.71, 0.95, 0.35, 0.93, 0.26, 0.50, 0.57, 8.74,
  2021, 0.22, 0.80, 3.80, 2.02, 3.65, 0.84, 0.34, 0.27, 0.28, 0.08, 0.07, 0.16, 12.53,
  2022, 0.78, 0.94, 1.17, 0.06, 2.59, 0.58, 0.99, 1.45, 1.25, 0.46, 0.47, 1.18, 11.92,
  2023, 1.25, 0.25, 0.49, 0.80, 5.53, 6.10, 2.10, 0.93, 0.67, 0.52, 0.18, 0.12, 18.94,
  2024, 0.28, 1.46, 1.65, 3.28, 1.70, 0.36, 1.10, 0.92, 1.24, 0.11, 1.98, 0.04, 14.12,
  2025, 0.52, 0.22, 1.26, 0.50, 3.57, 2.23, 0.64, 4.12, 1.76, NA, NA, NA, NA
)

# Optional: Convert to long format for analysis
denver_precip_long <- denver_precip %>%
  pivot_longer(cols = Jan:Dec, 
               names_to = 'Month',
               values_to = 'Precipitation') %>%
  mutate(Month = factor(Month, levels = month.abb))

denver_precip_long %>% 
  select(-Annual) -> denver_precip_long

```



```{r}

library(tidyverse)

# Function to convert Fahrenheit to Celsius
f_to_c <- function(f) {
  (f - 32) * 5/9
}

# Calculate baseline average (1971-2000) and convert to Celsius
baseline_avg <- denver_temps %>%
  filter(Year >= 1971 & Year <= 2000) %>%
  select(Jan:Dec) %>%
  summarise(across(everything(), mean, na.rm = TRUE)) %>%
  pivot_longer(everything()) %>%
  summarise(baseline = mean(value)) %>%
  pull(baseline) %>%
  f_to_c()

# Calculate annual averages for 2018-2024 and convert to Celsius
recent_annual <- denver_temps %>%
  filter(Year >= 2018 & Year <= 2024) %>%
  rowwise() %>%
  mutate(annual_avg = f_to_c(mean(c_across(Jan:Dec), na.rm = TRUE))) %>%
  select(Year, annual_avg)

# Create the graph
ggplot(recent_annual, aes(x = Year, y = annual_avg)) +
  geom_hline(yintercept = baseline_avg, 
             color = "#4575b4", 
             linewidth = 1.2,
             linetype = "dashed") +
  geom_hline(yintercept = baseline_avg + 1.4, 
             color = "#feb24c", 
             linewidth = 0.8,
             linetype = "dotted") +
  geom_hline(yintercept = baseline_avg + 3.1, 
             color = "#fc4e2a", 
             linewidth = 0.8,
             linetype = "dotted") +
  geom_line(color = "#d73027", linewidth = 1.2) +
  geom_point(color = "#d73027", size = 4) +
  annotate("text", 
           x = 2018.5, 
           y = baseline_avg + 0.2, 
           label = paste0("1971-2000 Baseline (", round(baseline_avg, 1), "°C)"),
           hjust = 0,
           color = "#4575b4",
           size = 3.5) +
  annotate("text", 
           x = 2023.5, 
           y = baseline_avg + 1.4 + 0.2, 
           label = "+1.4°C (2050 low)",
           hjust = 0,
           color = "#feb24c",
           size = 3) +
  annotate("text", 
           x = 2023.5, 
           y = baseline_avg + 3.1 + 0.2, 
           label = "+3.1°C (2050 high)",
           hjust = 0,
           color = "#fc4e2a",
           size = 3) +
  scale_x_continuous(breaks = 2018:2024) +
  labs(
    title = "Denver Annual Average Temperature (2018-2024)",
    subtitle = "Compared to 1971-2000 Baseline and Mid-Century Projections",
    x = "Year",
    y = "Annual Average Temperature (°C)"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 16, face = "bold"),
    plot.subtitle = element_text(size = 12),
    panel.grid.minor = element_blank()
  )

# Print summary statistics
cat("\nBaseline Period (1971-2000) Average:", round(baseline_avg, 1), "°C\n")
cat("\nRecent Period Annual Averages:\n")
for(i in 1:nrow(recent_annual)) {
  diff <- recent_annual$annual_avg[i] - baseline_avg
  cat(recent_annual$Year[i], ": ", round(recent_annual$annual_avg[i], 1), 
      "°C (", ifelse(diff > 0, "+", ""), round(diff, 1), "°C)\n", sep = "")
}

```

```{r}

library(tidyverse)

# Calculate baseline average (1971-2000) and convert to cm
baseline_avg <- denver_precip %>%
  filter(Year >= 1971 & Year <= 2000) %>%
  select(Jan:Dec) %>%
  summarise(across(everything(), mean, na.rm = TRUE)) %>%
  pivot_longer(everything()) %>%
  summarise(baseline = mean(value) * 2.54) %>%  # Convert inches to cm
  pull(baseline)

# Calculate baseline total annual precipitation (sum)
baseline_total <- denver_precip %>%
  filter(Year >= 1971 & Year <= 2000) %>%
  rowwise() %>%
  mutate(annual_total = sum(c_across(Jan:Dec), na.rm = TRUE) * 2.54) %>%
  ungroup() %>%
  summarise(baseline_total = mean(annual_total)) %>%
  pull(baseline_total)

# Calculate annual averages and totals for 2018-2024 and convert to cm
recent_annual <- denver_precip %>%
  filter(Year >= 2018 & Year <= 2024) %>%
  rowwise() %>%
  mutate(
    annual_avg = mean(c_across(Jan:Dec), na.rm = TRUE) * 2.54,  # Convert to cm
    annual_total = sum(c_across(Jan:Dec), na.rm = TRUE) * 2.54  # Total precipitation
  ) %>%
  select(Year, annual_avg, annual_total)

# Create the graph
ggplot(recent_annual, aes(x = Year, y = annual_total)) +
  geom_hline(yintercept = baseline_total, 
             color = "#4575b4", 
             linewidth = 1.2,
             linetype = "dashed") +
  geom_hline(yintercept = baseline_total * 0.93, 
             color = "#d8b365", 
             linewidth = 0.8,
             linetype = "dotted") +
  geom_hline(yintercept = baseline_total * 1.07, 
             color = "#5ab4ac", 
             linewidth = 0.8,
             linetype = "dotted") +
  geom_line(color = "#1b7837", linewidth = 1.2) +
  geom_point(color = "#1b7837", size = 4) +
  annotate("text", 
           x = 2018.5, 
           y = baseline_total + 2, 
           label = paste0("1971-2000 Baseline (", round(baseline_total, 1), " cm)"),
           hjust = 0,
           color = "#4575b4",
           size = 3.5) +
  annotate("text", 
           x = 2023.5, 
           y = baseline_total * 0.93 - 2, 
           label = "-7% (2050 dry)",
           hjust = 0,
           color = "#d8b365",
           size = 3) +
  annotate("text", 
           x = 2023.5, 
           y = baseline_total * 1.07 + 2, 
           label = "+7% (2050 wet)",
           hjust = 0,
           color = "#5ab4ac",
           size = 3) +
  scale_x_continuous(breaks = 2018:2024) +
  labs(
    title = "Denver Annual Total Precipitation (2018-2024)",
    subtitle = "Compared to 1971-2000 Baseline and Mid-Century Projections",
    x = "Year",
    y = "Annual Total Precipitation (cm)"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 16, face = "bold"),
    plot.subtitle = element_text(size = 12),
    panel.grid.minor = element_blank()
  )

# Print summary statistics
cat("\nBaseline Period (1971-2000) Average:", round(baseline_avg, 1), "cm per month\n")
cat("Baseline Period (1971-2000) Total:", round(baseline_total, 1), "cm per year\n")
cat("\nRecent Period Annual Averages and Totals:\n")
for(i in 1:nrow(recent_annual)) {
  diff_avg <- recent_annual$annual_avg[i] - baseline_avg
  diff_total <- recent_annual$annual_total[i] - baseline_total
  cat(recent_annual$Year[i], ":\n")
  cat("  Monthly average: ", round(recent_annual$annual_avg[i], 1), 
      " cm (", ifelse(diff_avg > 0, "+", ""), round(diff_avg, 1), " cm)\n", sep = "")
  cat("  Annual total: ", round(recent_annual$annual_total[i], 1), 
      " cm (", ifelse(diff_total > 0, "+", ""), round(diff_total, 1), " cm)\n", sep = "")
}

```

